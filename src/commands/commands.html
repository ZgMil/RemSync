<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->

<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
</head>

<body>
  <script>
  Office.onReady(() => {
    console.log('Commands ready');
  });

  function ShowTaskPane(event) {
    try {
      // Force taskpane to show in current window context
      Office.context.ui.displayDialogAsync('https://localhost:3000/taskpane.html', 
        { height: 60, width: 30, displayInIframe: true },
        function (asyncResult) {
          if (asyncResult.status === "failed") {
            // Fallback to default method if dialog fails
            Office.addin.showAsTaskpane()
              .then(() => event.completed())
              .catch(() => event.completed());
          } else {
            event.completed();
          }
        }
      );
    } catch (error) {
      // Final fallback
      Office.addin.showAsTaskpane()
        .then(() => event.completed())
        .catch(() => event.completed());
    }
  }
</script>

</body>

</html>